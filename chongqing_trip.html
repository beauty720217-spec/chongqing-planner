<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>é‡æ…¶é­”å¹»å±±åŸä¹‹æ—…</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="é‡æ…¶ä¹‹æ—…">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#7f1d1d">
    
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3125/3125848.png">
    <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/512/3125/3125848.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+TC:wght@400;500;700&family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* åŸºç¤è¨­å®š */
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
            overscroll-behavior-y: none;
            background-color: #2c2c2c; 
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23444444' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        .font-serif-tc { font-family: 'Noto Serif TC', serif; }
        .font-calligraphy { font-family: 'Ma Shan Zheng', cursive; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .animate-fadeIn { animation: fadeIn 0.6s ease-out forwards; }
        .animate-slideUp { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        .animate-bounce-slight { animation: bounceSlight 2s infinite; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes bounceSlight { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(3px); } }

        .bg-rice-paper {
            background-color: #f9f7f2;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
        }

        .bg-clouds {
            background-color: #7f1d1d;
            background-image: url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M50 50c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10c0 5.523-4.477 10-10 10s-10-4.477-10-10 4.477-10 10-10zM10 10c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10c0 5.523-4.477 10-10 10S0 25.523 0 20s4.477-10 10-10zm10 8c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm40 40c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8z' /%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
    </style>
</head>
<body class="flex justify-center items-start min-h-screen">

    <div id="root" class="w-full max-w-md bg-rice-paper min-h-screen shadow-2xl relative border-x border-gray-300">
        <div class="flex items-center justify-center h-screen text-stone-600 font-serif-tc">
            <div class="text-center">
                <div class="text-3xl mb-2 font-calligraphy text-red-800">å±±åŸãƒ»é‡æ…¶</div>
                <div class="text-sm tracking-widest">è¼‰å…¥ä¸­...</div>
            </div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICON çµ„ä»¶ ---
        const IconBase = ({ children, className, size = 20, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );
        const MapPin = (props) => <IconBase {...props}><path d="M20 10c0 6-9 13-9 13s-9-7-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></IconBase>;
        const Info = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></IconBase>;
        const CalendarIcon = (props) => <IconBase {...props}><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></IconBase>;
        const AlertCircle = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></IconBase>;
        const XIcon = (props) => <IconBase {...props}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></IconBase>;
        const MapIcon = (props) => <IconBase {...props}><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon><line x1="8" y1="2" x2="8" y2="18"></line><line x1="16" y1="6" x2="16" y2="22"></line></IconBase>;
        const Navigation = (props) => <IconBase {...props}><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></IconBase>;
        const ChevronRight = (props) => <IconBase {...props}><polyline points="9 18 15 12 9 6"></polyline></IconBase>;
        const Camera = (props) => <IconBase {...props}><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></IconBase>;
        const Cloud = (props) => <IconBase {...props}><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></IconBase>;
        const CloudRain = (props) => <IconBase {...props}><line x1="16" y1="13" x2="16" y2="21"></line><line x1="8" y1="13" x2="8" y2="21"></line><line x1="12" y1="15" x2="12" y2="23"></line><path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"></path></IconBase>;
        const Sun = (props) => <IconBase {...props}><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></IconBase>;
        const Umbrella = (props) => <IconBase {...props}><path d="M23 12a11.05 11.05 0 0 0-22 0zm-5 7a3 3 0 0 1-6 0v-7"></path></IconBase>;
        const Shirt = (props) => <IconBase {...props}><path d="M20.38 3.46L16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z"></path></IconBase>;
        const ExternalLink = (props) => <IconBase {...props}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></IconBase>;
        const ClockIcon = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></IconBase>;
        const LuggageIcon = (props) => <IconBase {...props}><rect x="6" y="8" width="12" height="12" rx="2" ry="2"></rect><path d="M8 8V6a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><circle cx="9" cy="15" r="1"></circle><circle cx="15" cy="15" r="1"></circle></IconBase>;
        const HotelBedIcon = (props) => <IconBase {...props}><path d="M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8"></path><path d="M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4"></path><path d="M12 4v6"></path><path d="M2 18h20"></path></IconBase>;
        const CurrencyIcon = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"></circle><path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"></path><line x1="12" y1="18" x2="12" y2="22"></line><line x1="12" y1="2" x2="12" y2="6"></line></IconBase>;
        const CarIcon = (props) => <IconBase {...props}><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"></path><circle cx="7" cy="17" r="2"></circle><circle cx="17" cy="17" r="2"></circle></IconBase>;
        const ArrowDown = (props) => <IconBase {...props}><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></IconBase>;
        const PhoneIcon = (props) => <IconBase {...props}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></IconBase>;
        
        const CutePlaneIcon = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 20} height={props.size || 20} viewBox="0 0 24 24" fill="currentColor" stroke="none" className={props.className} {...props}>
                <path d="M21,16v-2l-8-5V3.5c0-0.83-0.67-1.5-1.5-1.5S10,2.67,10,3.5V9l-8,5v2l8-2.5V19l-2,1.5V22l3.5-1l3.5,1v-1.5L13,19v-5.5L21,16z"></path>
            </svg>
        );

        // --- èˆªç­è³‡è¨Šè³‡æ–™ ---
        const flightDetailsKHH = {
            city: "é«˜é›„ (KHH)",
            outbound: {
                date: "2026/03/03 (é€±äºŒ)",
                legs: [
                    { flight: "CX431", from: "é«˜é›„ KHH", to: "é¦™æ¸¯ HKG", dep: "11:25", arr: "13:10", terminal_d: "I", terminal_a: "T1" },
                    { flight: "CX6130", from: "é¦™æ¸¯ HKG", to: "é‡æ…¶ CKG", dep: "15:25", arr: "18:05", terminal_d: "T1", terminal_a: "T3" }
                ],
                transferTime: "2å°æ™‚ 15åˆ†",
                checkInTime: "08:55", 
            },
            inbound: {
                date: "2026/03/07 (é€±å…­)",
                legs: [
                    { flight: "CX929", from: "é‡æ…¶ CKG", to: "é¦™æ¸¯ HKG", dep: "17:20", arr: "19:45", terminal_d: "T3", terminal_a: "T1" },
                    { flight: "CX448", from: "é¦™æ¸¯ HKG", to: "é«˜é›„ KHH", dep: "21:50", arr: "23:15", terminal_d: "T1", terminal_a: "I" }
                ],
                transferTime: "2å°æ™‚ 05åˆ†",
                checkInTime: "14:50",
            }
        };

        const flightDetailsTPE = {
            city: "å°åŒ— (TSA/TPE)",
            outbound: {
                date: "2026/03/03 (é€±äºŒ)",
                legs: [
                    { flight: "FM802", from: "å°åŒ— TSA", to: "ä¸Šæµ· PVG", dep: "12:20", arr: "14:20", terminal_d: "T1", terminal_a: "T2" },
                    { flight: "FM9549", from: "ä¸Šæµ· PVG", to: "é‡æ…¶ CKG", dep: "16:10", arr: "19:20", terminal_d: "T1", terminal_a: "T3" }
                ],
                transferTime: "1å°æ™‚ 50åˆ†",
                checkInTime: "10:20", 
            },
            inbound: {
                date: "2026/03/07 (é€±å…­)",
                legs: [
                    { flight: "CX929", from: "é‡æ…¶ CKG", to: "é¦™æ¸¯ HKG", dep: "17:20", arr: "19:45", terminal_d: "T3", terminal_a: "T1" },
                    { flight: "CX408", from: "é¦™æ¸¯ HKG", to: "å°åŒ— TPE", dep: "22:55", arr: "00:35(+1)", terminal_d: "T1", terminal_a: "T1" }
                ],
                transferTime: "3å°æ™‚ 10åˆ†",
                checkInTime: "15:20", 
            }
        };

        // --- å½ˆçª—çµ„ä»¶ ---
        const FlightModal = ({ onClose, location }) => {
            const data = location === 'TPE' ? flightDetailsTPE : flightDetailsKHH;
            const themeColor = location === 'TPE' ? 'bg-indigo-800' : 'bg-slate-700';
            const themeText = location === 'TPE' ? 'text-indigo-800' : 'text-slate-700';
            const tripOrderLink = "https://www.trip.com/trips"; 

            return (
                <div className="fixed inset-0 bg-stone-900/70 z-50 flex items-center justify-center p-4 animate-fadeIn backdrop-blur-sm" onClick={onClose}>
                    <div className="bg-[#f9f7f2] w-full max-w-sm rounded-xl overflow-hidden shadow-2xl animate-slideUp flex flex-col max-h-[85vh] border border-[#d6d3c9]" onClick={e => e.stopPropagation()}>
                        
                        <div className={`${themeColor} p-4 text-[#f9f7f2] flex justify-between items-center shrink-0 border-b-2 border-[#b45309]`}>
                            <div className="flex items-center space-x-2">
                                <CutePlaneIcon size={20} className="text-[#f9f7f2]" />
                                <h2 className="font-serif-tc font-bold text-lg tracking-wider">èˆªç­è³‡è¨Šãƒ»{data.city}</h2>
                            </div>
                            <button onClick={onClose} className="p-1 hover:bg-white/10 rounded-full transition-colors"><XIcon size={20} /></button>
                        </div>
                        
                        <div className="overflow-y-auto p-4 space-y-6 flex-1">
                            {/* å»ç¨‹ */}
                            <div className="bg-white rounded-lg p-4 shadow-sm border border-[#e5e2d6] relative">
                                <div className="absolute top-0 right-0 w-16 h-16 opacity-10 pointer-events-none">
                                    <svg viewBox="0 0 100 100" fill="currentColor"><circle cx="50" cy="50" r="40"/></svg>
                                </div>
                                <div className="flex justify-between items-center mb-3 pb-2 border-b border-dashed border-gray-200">
                                    <span className={`${themeText} font-serif-tc font-bold flex items-center text-lg`}>
                                        <span className={`${themeColor} text-white px-2 py-0.5 text-xs mr-2 rounded-sm`}>å»ç¨‹</span> 
                                        {data.outbound.date}
                                    </span>
                                </div>
                                
                                <div className="flex items-start mb-3">
                                    <div className="mr-3 mt-1 text-stone-400"><LuggageIcon size={16} /></div>
                                    <div>
                                        <div className="text-xs font-bold text-stone-500">å»ºè­° Check-in</div>
                                        <div className={`text-xl ${themeText} font-bold font-serif-tc`}>{data.outbound.checkInTime}</div>
                                        <div className="text-xs text-stone-400 font-serif-tc">{location === 'TPE' ? 'å°åŒ—æ¾å±± (TSA)' : 'é«˜é›„å°æ¸¯ (KHH)'}</div>
                                    </div>
                                </div>

                                <div className="space-y-0 relative">
                                    {data.outbound.legs.map((leg, index) => (
                                        <div key={index}>
                                            <div className={`flex justify-between items-start relative z-10 bg-white ${index === 0 ? 'pb-3' : 'pt-1'}`}>
                                                <div>
                                                    <div className="text-lg font-bold text-stone-800 font-serif-tc">{leg.dep}</div>
                                                    <div className="text-xs text-stone-500 font-medium bg-stone-100 px-1 rounded-sm inline-block">{leg.from.split(' ')[1]} {leg.terminal_d && `(${leg.terminal_d})`}</div>
                                                </div>
                                                <div className="flex-1 px-3 flex flex-col items-center mt-1">
                                                    <div className="text-[10px] text-stone-400 mb-0.5 tracking-wider">{leg.flight}</div>
                                                    <div className="w-full h-[1px] bg-stone-300 relative">
                                                        <div className="absolute right-0 -top-[3px] w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                                                    </div>
                                                    <div className="text-[10px] text-stone-400 mt-0.5">
                                                        {location === 'TPE' ? (index === 0 ? '2h 00m' : '3h 10m') : (index === 0 ? '1h 45m' : '2h 40m')}
                                                    </div>
                                                </div>
                                                <div className="text-right">
                                                    <div className="text-lg font-bold text-stone-800 font-serif-tc">{leg.arr}</div>
                                                    <div className="text-xs text-stone-500 font-medium bg-stone-100 px-1 rounded-sm inline-block">{leg.to.split(' ')[1]} {leg.terminal_a && `(${leg.terminal_a})`}</div>
                                                </div>
                                            </div>
                                            {index === 0 && data.outbound.legs.length > 1 && (
                                                <div className="bg-amber-50 border border-amber-100 rounded-sm p-1.5 my-2 text-center relative z-10">
                                                    <div className="text-xs text-amber-700 font-medium flex justify-center items-center font-serif-tc">
                                                        <ClockIcon size={12} className="mr-1" />
                                                        è½‰æ©Ÿç­‰å¾…ï¼š{data.outbound.transferTime}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* å›ç¨‹ */}
                            <div className="bg-white rounded-lg p-4 shadow-sm border border-[#e5e2d6]">
                                 <div className="flex justify-between items-center mb-3 pb-2 border-b border-dashed border-gray-200">
                                    <span className="text-emerald-800 font-serif-tc font-bold flex items-center text-lg">
                                        <span className="bg-emerald-800 text-white px-2 py-0.5 text-xs mr-2 rounded-sm">å›ç¨‹</span> 
                                        {data.inbound.date}
                                    </span>
                                </div>

                                 <div className="flex items-start mb-3">
                                    <div className="mr-3 mt-1 text-stone-400"><LuggageIcon size={16} /></div>
                                    <div>
                                        <div className="text-xs font-bold text-stone-500">å»ºè­°æŠµé”æ©Ÿå ´</div>
                                        <div className="text-xl text-emerald-800 font-bold font-serif-tc">{data.inbound.checkInTime}</div>
                                        <div className="text-xs text-stone-400 font-serif-tc">é‡æ…¶æ±ŸåŒ—æ©Ÿå ´ (CKG)</div>
                                    </div>
                                </div>

                                <div className="space-y-0 relative">
                                    {data.inbound.legs.map((leg, index) => (
                                        <div key={index}>
                                            <div className={`flex justify-between items-start relative z-10 bg-white ${index === 0 ? 'pb-3' : 'pt-1'}`}>
                                                <div>
                                                    <div className="text-lg font-bold text-stone-800 font-serif-tc">{leg.dep}</div>
                                                    <div className="text-xs text-stone-500 font-medium bg-stone-100 px-1 rounded-sm inline-block">{leg.from.split(' ')[1]} {leg.terminal_d && `(${leg.terminal_d})`}</div>
                                                </div>
                                                <div className="flex-1 px-3 flex flex-col items-center mt-1">
                                                    <div className="text-[10px] text-stone-400 mb-0.5 tracking-wider">{leg.flight}</div>
                                                    <div className="w-full h-[1px] bg-stone-300 relative">
                                                        <div className="absolute right-0 -top-[3px] w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                                                    </div>
                                                    <div className="text-[10px] text-stone-400 mt-0.5">
                                                        {location === 'TPE' ? (index === 0 ? '2h 25m' : '1h 40m') : (index === 0 ? '2h 25m' : '1h 25m')}
                                                    </div>
                                                </div>
                                                <div className="text-right">
                                                    <div className="text-lg font-bold text-stone-800 font-serif-tc">{leg.arr}</div>
                                                    <div className="text-xs text-stone-500 font-medium bg-stone-100 px-1 rounded-sm inline-block">{leg.to.split(' ')[1]} {leg.terminal_a && `(${leg.terminal_a})`}</div>
                                                </div>
                                            </div>
                                            {index === 0 && data.inbound.legs.length > 1 && (
                                                <div className="bg-amber-50 border border-amber-100 rounded-sm p-1.5 my-2 text-center relative z-10">
                                                    <div className="text-xs text-amber-700 font-medium flex justify-center items-center font-serif-tc">
                                                        <ClockIcon size={12} className="mr-1" />
                                                        è½‰æ©Ÿç­‰å¾…ï¼š{data.inbound.transferTime}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        <div className="p-4 bg-[#f9f7f2] border-t border-[#d6d3c9] shrink-0 z-20">
                            <a 
                                href={tripOrderLink}
                                target="_blank"
                                rel="noopener noreferrer"
                                className={`w-full py-3 rounded-lg font-bold text-white flex items-center justify-center shadow-md transform transition-all active:scale-95 hover:brightness-110 ${themeColor}`}
                            >
                                <ExternalLink size={18} className="mr-2" />
                                å‰å¾€ Trip æŸ¥çœ‹è¨‚å–®
                            </a>
                        </div>
                    </div>
                </div>
            );
        };

        const ExchangeModal = ({ onClose }) => {
            const [rmb, setRmb] = useState('');
            const rate = 4.5; 

            return (
                <div className="fixed inset-0 bg-stone-900/70 z-50 flex items-center justify-center p-4 animate-fadeIn backdrop-blur-sm" onClick={onClose}>
                    <div className="bg-[#f9f7f2] w-full max-w-xs rounded-xl p-6 shadow-2xl animate-slideUp text-center border border-[#d6d3c9]" onClick={e => e.stopPropagation()}>
                        <div className="bg-yellow-600/10 w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-4 text-yellow-700 border border-yellow-600/20">
                            <div className="font-serif-tc font-bold text-2xl">Â¥</div>
                        </div>
                        <h3 className="text-xl font-bold text-stone-800 mb-6 font-serif-tc">åŒ¯ç‡æ›ç®—</h3>
                        <div className="flex items-center space-x-2 mb-4 bg-white p-3 rounded-lg border border-stone-300">
                            <span className="text-stone-500 font-serif-tc px-2 text-lg">äººæ°‘å¹£</span>
                            <input 
                                type="number" 
                                value={rmb} 
                                onChange={e => setRmb(e.target.value)} 
                                placeholder="è¼¸å…¥é‡‘é¡" 
                                className="w-full bg-transparent outline-none text-2xl font-bold text-stone-800 text-right"
                                autoFocus
                            />
                        </div>
                        <div className="mb-6 py-4 border-t border-dashed border-stone-300">
                            <div className="text-xs text-stone-500 mb-1">ç´„ç­‰æ–¼æ–°å°å¹£ (x{rate})</div>
                            <div className="text-4xl font-black text-stone-800 font-serif-tc tracking-tight">
                                <span className="text-sm align-top mt-2 inline-block mr-1">NT$</span>
                                {rmb ? Math.round(rmb * rate).toLocaleString() : '0'}
                            </div>
                        </div>
                        <button onClick={onClose} className="w-full py-3 bg-stone-800 text-[#f9f7f2] rounded-lg font-medium font-serif-tc hover:bg-stone-900 transition-colors">é—œé–‰</button>
                    </div>
                </div>
            );
        };

        const HotelModal = ({ onClose }) => (
            <div className="fixed inset-0 bg-stone-900/70 z-50 flex items-center justify-center p-4 animate-fadeIn backdrop-blur-sm" onClick={onClose}>
                <div className="bg-[#f9f7f2] w-full max-w-sm rounded-xl overflow-hidden shadow-2xl animate-slideUp flex flex-col max-h-[85vh] border border-[#d6d3c9]" onClick={e => e.stopPropagation()}>
                     <div className="bg-[#1F2937] p-4 text-[#f9f7f2] flex justify-between items-center shrink-0 border-b-2 border-[#b45309]">
                        <div className="flex items-center space-x-2">
                            <HotelBedIcon size={20} className="text-[#f9f7f2]" />
                            <h2 className="font-serif-tc font-bold text-lg tracking-wider">ä½å®¿è³‡è¨Šãƒ»å¶¼é‡Œ</h2>
                        </div>
                        <button onClick={onClose} className="p-1 hover:bg-white/20 rounded-full transition-colors"><XIcon size={20} /></button>
                    </div>
                    
                    <div className="p-6 overflow-y-auto flex-1">
                        <div className="flex items-start space-x-3 mb-5">
                            <div className="bg-stone-200 p-2.5 rounded-full text-stone-700 mt-1">
                                <MapPin size={24} />
                            </div>
                            <div>
                                <h3 className="text-xl font-bold text-stone-800 leading-tight mb-1 font-serif-tc">å¶¼é‡Œæ°‘å®¿</h3>
                                <div className="text-xs text-stone-600 font-medium bg-stone-200 px-2 py-1 rounded-sm inline-block">è§€éŸ³æ©‹æ­¥è¡Œè¡—åº—</div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg p-4 mb-6 border border-stone-200 shadow-sm">
                            <div className="text-xs text-stone-400 mb-1 font-serif-tc">åœ°å€ Address</div>
                            <div className="text-base font-medium text-stone-700 leading-relaxed font-serif-tc">
                                é‡æ…¶å¸‚æ±ŸåŒ—å€å»ºæ–°å—è·¯21è™Ÿ<br/>
                                <span className="text-stone-500 text-sm">ç…Œè¯æ™¶èƒåŸ5æ£Ÿ</span>
                            </div>
                        </div>

                        <div className="mb-6">
                            <h4 className="text-sm font-bold text-stone-800 mb-3 flex items-center font-serif-tc">
                                <span className="w-1 h-4 bg-[#b45309] rounded-full mr-2"></span>
                                è¯çµ¡ç®¡å®¶
                            </h4>
                            <div className="flex space-x-3">
                                <a href="tel:+861992315xxxx" className="flex-1 bg-emerald-50 text-emerald-800 py-2.5 rounded-lg flex items-center justify-center font-bold text-sm border border-emerald-100">
                                    <PhoneIcon size={16} className="mr-2" />
                                    æ’¥æ‰“é›»è©±
                                </a>
                                <div className="flex-1 bg-stone-50 text-stone-500 py-2.5 rounded-lg flex items-center justify-center text-xs border border-stone-100 text-center px-2">
                                    è«‹æŸ¥çœ‹è¨‚å–®ç²å–çœŸå¯¦è™Ÿç¢¼
                                </div>
                            </div>
                            <p className="text-[10px] text-stone-400 mt-2 text-center">å…¥ä½ç•¶å¤©è«‹ç•™æ„è¨‚æˆ¿å¹³å°è¨Šæ¯ç²å–å¯†ç¢¼</p>
                        </div>
                         
                        <div className="mb-6">
                             <h4 className="text-sm font-bold text-stone-800 mb-3 flex items-center font-serif-tc">
                                <span className="w-1 h-4 bg-[#b45309] rounded-full mr-2"></span>
                                å‘¨é‚Šæ¨è–¦
                            </h4>
                            <div className="space-y-2">
                                {[
                                    { icon: "ğŸœ", name: "è§€éŸ³æ©‹å¥½åƒè¡—", desc: "å¿…åƒï¼šçƒ¤è±¬è¹„ã€é™é¾çˆªçˆªã€é…¸è¾£ç²‰ã€‚é‡æ…¶ç¾é£Ÿå¯†åº¦æœ€é«˜è™•ã€‚", tag: "è¶…è¿‘", tagColor: "text-[#b45309] bg-orange-50" },
                                    { icon: "ğŸ¨", name: "åŒ—å€‰æ–‡å‰µåœ’", desc: "å‰èº«ç‚ºæ±ŸåŒ—ç´¡ç¹”å€‰åº«ï¼Œç¾ç‚ºæ–‡é’æ‹ç…§è–åœ°ã€‚é©åˆåˆå¾Œæ•£æ­¥ã€‚", tag: "800m", tagColor: "text-stone-500" },
                                    { icon: "ğŸ¸", name: "ä¸å¤œä¹è¡—", desc: "é‡æ…¶å¤œç”Ÿæ´»åœ°æ¨™ã€‚æ¨è–¦é…’å§ï¼šPlay Houseã€‚æ„Ÿå—å‡Œæ™¨ä¸‰é»çš„ç†±é¬§ã€‚", tag: "1.5km", tagColor: "text-stone-500" }
                                ].map((item, idx) => (
                                    <div key={idx} className="flex items-center justify-between p-3 bg-white rounded-lg border border-stone-100 shadow-sm">
                                        <div className="flex items-center">
                                            <div className="text-lg mr-3 opacity-80">{item.icon}</div>
                                            <div className="flex-1 mr-2">
                                                <div className="text-sm font-bold text-stone-700 font-serif-tc">{item.name}</div>
                                                <div className="text-xs text-stone-400 leading-tight mt-0.5">{item.desc}</div>
                                            </div>
                                        </div>
                                        <span className={`text-xs font-medium ${item.tagColor} px-2 py-1 rounded whitespace-nowrap`}>{item.tag}</span>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="grid grid-cols-2 gap-3 pt-2 border-t border-stone-200">
                             <a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent("é‡åº†å¸‚æ±ŸåŒ—åŒºå»ºæ–°å—è·¯21å·")}`} target="_blank" className="flex items-center justify-center py-2.5 bg-[#b45309] text-white rounded-lg font-medium text-sm hover:bg-[#92400e] transition-colors shadow-sm">
                                <MapPin size={16} className="mr-1.5" /> é–‹å•Ÿåœ°åœ–
                            </a>
                            <button onClick={onClose} className="flex items-center justify-center py-2.5 bg-stone-100 text-stone-700 rounded-lg font-medium text-sm hover:bg-stone-200 transition-colors border border-stone-200">
                                é—œé–‰
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        );

        const ChongqingTripApp = () => {
            const [activeTab, setActiveTab] = useState('day1');
            const [view, setView] = useState('itinerary'); 
            const [expandedMapIndex, setExpandedMapIndex] = useState(null);
            const [flightModalInfo, setFlightModalInfo] = useState(null); 
            const [showExchangeModal, setShowExchangeModal] = useState(false);
            const [showHotelModal, setShowHotelModal] = useState(false);

            const tripInfo = {
                title: "é‡æ…¶é­”å¹»å±±åŸä¹‹æ—…",
                date: "2026/03/03 (äºŒ) ï½ 03/07 (å…­)", 
                location: "å¶¼é‡Œæ°‘å®¿ï¼ˆé‡æ…¶è§€éŸ³æ©‹æ­¥è¡Œè¡—åº—ï¼‰", 
                tips: "é‡æ…¶åœ°å½¢ç‰¹æ®Šï¼Œæ­¥è¡Œéœ€ç©¿èˆ’é©é‹å±¥ï¼›D3å»ºè­°åŒ…è»Šã€‚",
            };

            const weatherData = {
                day1: { temp: "11-16Â°C", condition: "å¤šé›²æ™‚é™°", icon: Cloud, tip: "å¾®æ¶¼ï¼Œèˆ’é©è–„å¤–å¥—" },
                day2: { temp: "12-17Â°C", condition: "é™°è½‰å°é›¨", icon: CloudRain, tip: "æ”œå¸¶é›¨å…·ï¼Œé˜²æ»‘é‹" },
                day3: { temp: "10-15Â°C", condition: "å°é›¨", icon: Umbrella, tip: "å±±å€è¼ƒæ¶¼ï¼Œéœ€ä¿æš–å¤–å¥—" },
                day4: { temp: "11-18Â°C", condition: "å¤šé›²", icon: Sun, tip: "æ—©æ™šæº«å·®å¤§ï¼Œæ´‹è”¥å¼ç©¿æ­" },
                day5: { temp: "13-19Â°C", condition: "æ™´æ™‚å¤šé›²", icon: Sun, tip: "èˆ’é©ï¼Œé©åˆé€›è¡—" }
            };

            // --- æ·±åº¦å°éŠç‰ˆè¡Œç¨‹è³‡æ–™ (åŠ å…¥æ­·å²èˆ‡èœå–®) ---
            const itineraryData = {
                day1: {
                    date: "3/03 (äºŒ)",
                    title: "åˆæŠµå±±åŸ",
                    subtitle: "æŠµé”é‡æ…¶ & å•†åœˆåˆé«”é©—",
                    highlight: "è§€éŸ³æ©‹å¥½åƒè¡—ã€ä¹è¡—å¤œç”Ÿæ´»",
                    events: [
                        { 
                            time: "18:05", 
                            title: "æŠµé”é‡æ…¶æ±ŸåŒ—æ©Ÿå ´", 
                            desc: "CX6130 æŠµé”ã€‚å…¥å¢ƒT3èˆªç«™/7è™Ÿå‡ºå£ã€‚ğŸ’¡æ‰“å¡é»ï¼šåˆ¥å¿˜äº†æ‹å‚³èªªä¸­çš„ã€Œé»ƒè‰²æ³•æ‹‰åˆ©ã€ï¼ˆé‡æ…¶ç‰¹æœ‰çš„é»ƒè‰²Suzukiè¨ˆç¨‹è»Šï¼‰ï¼Œé€™æ˜¯å±±åŸç¨æœ‰çš„é¢¨æ™¯ç·šã€‚", 
                            emoji: "âœˆï¸", 
                            location: "é‡æ…¶æ±ŸåŒ—åœ‹éš›æ©Ÿå ´T3èˆªç«™æ¨“",
                            opening: "24å°æ™‚é–‹æ”¾",
                            travelToNext: { dist: "23å…¬é‡Œ", time: "35åˆ†" }
                        },
                        { 
                            time: "æ™šé¤", 
                            title: "è§€éŸ³æ©‹å•†åœˆ", 
                            desc: "ğŸ“œ é‡æ…¶æœ€æ½®çš„å•†åœˆï¼Œç¾å¥³å¯†åº¦æœ€é«˜ã€‚ğŸ¥¢ å¿…åƒæ¨è–¦ï¼šã€è‹•çš®è±†å¹²ã€‘(è»Ÿç³¯Qå½ˆ)ã€ã€ä¸å®¶é…¥è‚‰ã€‘(ç¾ç‚¸é…¥è„†)ã€ã€åŠ‰é…¥è‚‰ã€‘ã€‚è‹¥æƒ³åƒæ­£é¤ï¼Œæ¨è–¦ã€æŒ‘æŒ‘è‚¥è…¸ã€‘ã€‚", 
                            type: "food", 
                            emoji: "ğŸŒ¶ï¸", 
                            location: "é‡æ…¶è§€éŸ³æ©‹æ­¥è¡Œè¡—",
                            opening: "æ­¥è¡Œè¡—å…¨å¤©ï¼Œå¥½åƒè¡— 10:00-22:00",
                            travelToNext: { dist: "1.2å…¬é‡Œ", time: "5åˆ†" }
                        },
                        { 
                            time: "æ™šä¸Š", 
                            title: "ä¹è¡— (ä¸å¤œä¹è¡—)", 
                            desc: "ğŸ“œ é€™è£¡æ²’æœ‰æ­·å²æ»„æ¡‘ï¼Œåªæœ‰å¹´è¼•äººçš„è·çˆ¾è’™ã€‚é‡æ…¶çš„è˜­æ¡‚åŠã€‚ğŸ“¸ é©åˆè¡—æ‹éœ“è™¹ç‡ˆç‰†ã€‚æ¨è–¦å®µå¤œï¼šã€ä¹æ‘çƒ¤è…¦èŠ±ã€‘(å£æ„Ÿåƒéµè‚ï¼Œæ•¢åƒä¸€å®šè¦è©¦)ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ»", 
                            location: "é‡æ…¶ä¹è¡—",
                            opening: "å…¨å¤©é–‹æ”¾ (æœ€ä½³é«”é©— 19:00 å¾Œ)"
                        }
                    ]
                },
                day2: {
                    date: "3/04 (ä¸‰)",
                    title: "é­”å¹»å¸‚å€",
                    subtitle: "å±±åŸæ­¥é“ & æ´ªå´–æ´å¤œæ™¯",
                    highlight: "18æ¢¯ã€è§£æ”¾ç¢‘ã€é­”å¹»å¤œæ™¯å‹•ç·š",
                    events: [
                        { 
                            time: "æ—©é¤", 
                            title: "é‡æ°´æºæ—©å¸‚", 
                            desc: "ğŸ“œ æœ€æ¥åœ°æ°£çš„èœå¸‚å ´ã€‚ğŸ¥¢ å¿…åƒï¼šå°‹æ‰¾å¸‚å ´è£¡çš„ã€è€éºµåŒ…å­ã€‘å’Œã€æ²¹èŒ¶ã€‘(é‡æ…¶ç‰¹è‰²æ—©é¤ï¼Œç±³ç³Šé‹ªä¸Šé¥Šå­)ã€‚", 
                            type: "food", 
                            emoji: "ğŸœ", 
                            location: "é‡æ…¶é‡æ°´æº",
                            opening: "ç´„ 06:00 - 12:00",
                            travelToNext: { dist: "7.5å…¬é‡Œ", time: "25åˆ†" }
                        },
                        { 
                            time: "ä¸Šåˆ", 
                            title: "å±±åŸæ­¥é“ & 18æ¢¯", 
                            desc: "ğŸ“œ åå…«æ¢¯æ˜¯æ˜”æ—¥é€£æ¥ã€Œä¸ŠåŠåŸã€(å¯Œäºº)èˆ‡ã€Œä¸‹åŠåŸã€(ç¢¼é ­)çš„å‘½è„ˆï¼Œä¹Ÿæ˜¯ã€Œæ£’æ£’è»ã€(æŒ‘å¤«)æ–‡åŒ–çš„ç™¼æºåœ°ã€‚å¾ã€Œä½³å¯¦é¤Šè€é™¢å…¥å£ã€é€²å…¥å¯æ‹åˆ°ç´…ç‰†è€æˆ¿ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ®", 
                            location: "é‡æ…¶å±±åŸå··",
                            opening: "å…¨å¤©é–‹æ”¾ (åº—é‹ªç´„ 09:00-21:00)",
                            travelToNext: { dist: "2.5å…¬é‡Œ", time: "10åˆ†" }
                        },
                        { 
                            time: "åˆé¤", 
                            title: "å±±åŸå®¶å¸¸èœ", 
                            desc: "ğŸ“ æ¸ä¸­å€äº”ä¸€è·¯250è™Ÿã€‚ğŸ¥¢ èœå–®æ¨è–¦ï¼šã€è™çš®è‚˜å­ã€‘(è»Ÿçˆ›å…¥å‘³)ã€ã€è“®è—•æ’éª¨æ¹¯ã€‘(è§£è¾£ç¥å™¨)ã€ã€è‚è…°åˆç‚’ã€‘(è€ƒé©—ç«å€™çš„ç¶“å…¸å·èœ)ã€‚", 
                            type: "food", 
                            emoji: "ğŸš", 
                            location: "é‡æ…¶æ¸ä¸­å€äº”ä¸€è·¯250è™Ÿ",
                            opening: "10:00 - 22:00",
                            travelToNext: { dist: "0.8å…¬é‡Œ", time: "5åˆ†" }
                        },
                        { 
                            time: "ä¸‹åˆ", 
                            title: "è§£æ”¾ç¢‘ & é­æ˜Ÿæ¨“", 
                            desc: "ğŸ“œ è§£æ”¾ç¢‘å…¨åã€ŒæŠ—æˆ°å‹åˆ©ç´€åŠŸç¢‘ã€ï¼Œæ˜¯äºŒæˆ°æ™‚ä¸­åœ‹å”¯ä¸€çš„ç²¾ç¥å ¡å£˜ï¼Œæ›¾ç¶“æ˜¯æœ€é«˜å»ºç¯‰ï¼Œç¾åœ¨è¢«é«˜æ¨“ç’°ç¹ï¼Œè¦‹è­‰æ™‚ä»£è®Šé·ã€‚éš¨å¾Œå»é­æ˜Ÿæ¨“é«”é©—ã€Œ22æ¨“æ˜¯å¹³åœ°ã€çš„é­”å¹»ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ™ï¸", 
                            location: "é‡æ…¶è§£æ”¾ç¢‘æ­¥è¡Œè¡—",
                            opening: "å…¨å¤©é–‹æ”¾",
                            travelToNext: { dist: "1.0å…¬é‡Œ", time: "5åˆ†" }
                        },
                        { 
                            time: "å‚æ™š", 
                            title: "é­”å¹»å¤œæ™¯å‹•ç·š", 
                            desc: "ğŸ“œ æ´ªå´–æ´é‡ç¾äº†å·´æ¸å‚³çµ±ã€ŒåŠè…³æ¨“ã€å»ºç¯‰ï¼Œå› é…·ä¼¼å®®å´é§¿ã€Šç¥éš±å°‘å¥³ã€‹æ¹¯å±‹è€Œçˆ†ç´…ã€‚ğŸ“¸ è·¯ç·šï¼šæ´ªå´–æ´(æ‹å…¨æ™¯)â†’åƒå»é–€å¤§æ©‹â†’æ±ŸåŒ—å˜´(æ‹å€’å½±)ã€‚", 
                            type: "camera", 
                            emoji: "ğŸ“¸", 
                            isHighlight: true, 
                            location: "é‡æ…¶æ´ªå´–æ´æ°‘ä¿—é¢¨è²Œå€",
                            opening: "å…¨å¤©é–‹æ”¾ (äº®ç‡ˆç´„ 18:30-23:00)",
                            travelToNext: { dist: "11å…¬é‡Œ", time: "30åˆ†" }
                        },
                        { 
                            time: "æ™šé¤", 
                            title: "å­å£è€çƒ§çƒ¤", 
                            desc: "ğŸ¥¢ å¯†å­å›æ¨è–¦ã€‚é€™æ˜¯ä¸€é–“é–‹åœ¨å±±è·¯é‚Šçš„å‚³å¥‡ç‡’çƒ¤ã€‚æ¨è–¦ï¼šã€çƒ¤è‹•çš®ã€‘(åŒ…é…¸è˜¿è””)ã€ã€å°è‚‰ä¸²ã€‘ã€ä»¥åŠå‹‡æ•¢è€…å¿…é»çš„ã€åŒ…æ¼¿è±†è…ã€‘ã€‚", 
                            type: "food", 
                            emoji: "ğŸ¢", 
                            location: "é‡æ…¶å—å±±å­å£",
                            opening: "17:00 - 02:00"
                        }
                    ]
                },
                day3: {
                    date: "3/05 (å››)",
                    title: "æ­¦éš†ä»™å¢ƒ",
                    subtitle: "å¤©ç”Ÿä¸‰æ©‹ & è‹—æ—é¢¨æƒ…",
                    highlight: "è®Šå½¢é‡‘å‰›å–æ™¯åœ°ã€ä¹é»åŸ",
                    events: [
                        { 
                            time: "æ—©æ™¨", 
                            title: "åŒ…è»Šå‡ºç™¼", 
                            desc: "ä»Šæ—¥å‰å¾€æ¸æ±å—å±±å€ï¼Œè·¯é€”é™é (å–®ç¨‹ç´„3hr)ï¼Œå»ºè­°åŒ…è»Šä»¥ä¿å­˜é«”åŠ›ã€‚", 
                            type: "transport", 
                            emoji: "ğŸš", 
                            location: "é‡æ…¶è§€éŸ³æ©‹",
                            travelToNext: { dist: "180å…¬é‡Œ", time: "2å°æ™‚40åˆ†" }
                        },
                        { 
                            time: "ä¸Šåˆ", 
                            title: "æ­¦éš†å¤©ç”Ÿä¸‰æ©‹", 
                            desc: "ğŸ“œ ä¸–ç•Œè‡ªç„¶éºç”¢ã€Œå–€æ–¯ç‰¹åœ°å½¢ã€çš„ä»£è¡¨ã€‚é€™è£¡æ˜¯å¼µè—è¬€ã€Šæ»¿åŸç›¡å¸¶é»ƒé‡‘ç”²ã€‹å”¯ä¸€å¤–æ™¯åœ°ï¼Œä¹Ÿæ˜¯ã€Šè®Šå½¢é‡‘å‰›4ã€‹æŸ¯åšæ–‡æ”¶æœæš´é¾é‡‘å‰›çš„åœ°æ–¹ã€‚è¨˜å¾—æŠ¬é ­çœ‹å¤©é¾æ©‹çš„æ°£å‹¢ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ”ï¸", 
                            isHighlight: true, 
                            location: "é‡æ…¶æ­¦éš†å¤©ç”Ÿä¸‰æ©‹",
                            opening: "08:30 - 16:30 (ä¾å­£ç¯€å¾®èª¿)",
                            travelToNext: { dist: "50å…¬é‡Œ", time: "50åˆ†" }
                        },
                        { 
                            time: "é€”ç¶“", 
                            title: "çƒæ±Ÿç•«å»Š", 
                            desc: "ğŸ“œ ã€Œåƒé‡Œçƒæ±Ÿï¼Œç™¾é‡Œç•«å»Šã€ã€‚ç¢§ç¶ æ±Ÿæ°´å…©å²¸æ˜¯éšªå³»çš„æ‡¸å´–ï¼Œå¤äººäº‘ã€Œèœ€é“é›£ã€åœ¨æ­¤å¯è¦‹ä¸€æ–‘ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ–¼ï¸", 
                            location: "é‡æ…¶çƒæ±Ÿç•«å»Š",
                            opening: "å…¨å¤©é–‹æ”¾",
                            travelToNext: { dist: "5å…¬é‡Œ", time: "10åˆ†" }
                        },
                        { 
                            time: "ä¸‹åˆ", 
                            title: "èš©å°¤ä¹é»åŸ", 
                            desc: "ğŸ“œ è‹—æ—å§‹ç¥–ã€Œèš©å°¤ã€çš„ä¸»é¡Œæ™¯å€ã€‚é›–ç„¶æ˜¯äººé€ æ™¯é»ï¼Œä½†å…¶ä¾å±±è€Œå»ºçš„åŠè…³æ¨“ç¾¤éå¸¸å£¯è§€ï¼Œæ“æœ‰ä¸–ç•Œæœ€å¤§çš„åŠè…³æ¨“å»ºç¯‰ç¾¤ã€‚ğŸ¥¢ è©¦è©¦è‹—æ—ç‰¹è‰²ã€é•·æ¡Œå®´ã€‘(è¦–åœ˜é«”æƒ…æ³)ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ‘¹", 
                            location: "é‡æ…¶èš©å°¤ä¹é»åŸ",
                            opening: "08:30 - 17:30",
                            travelToNext: { dist: "135å…¬é‡Œ", time: "2å°æ™‚10åˆ†" }
                        },
                        { 
                            time: "å‚æ™š", 
                            title: "è¿”å›å¸‚å€", 
                            desc: "è»Šç¨‹ç´„ 2 å°æ™‚ã€‚å¯ä»¥åœ¨è»Šä¸Šè£œçœ ã€‚", 
                            type: "transport", 
                            emoji: "â°", 
                            location: "é‡æ…¶å¸‚å€",
                            travelToNext: { dist: "5å…¬é‡Œ", time: "15åˆ†" }
                        },
                        { 
                            time: "æ™šé¤", 
                            title: "ç§‹é¦™çƒ¤é­šå¤§æ’æª”", 
                            desc: "ğŸ“ èæ™¯åŸè‡»è‹‘åº—ã€‚é‡æ…¶è¬å·çƒ¤é­šæœ€ç‚ºå‡ºåã€‚ğŸ¥¢ å¿…é»ï¼šã€è’œé¦™/éº»è¾£é›™æ‹¼çƒ¤é­šã€‘ï¼Œé…èœåŠ ã€é­”èŠ‹ã€‘ã€ã€è—•ç‰‡ã€‘å¸æ»¿æ¹¯æ±æ˜¯ç²¾è¯ã€‚", 
                            type: "food", 
                            emoji: "ğŸŸ", 
                            location: "é‡æ…¶èæ™¯åŸè‡»è‹‘",
                            opening: "16:00 - 02:00"
                        }
                    ]
                },
                day4: {
                    date: "3/06 (äº”)",
                    title: "å—å²¸èˆŠå¤¢",
                    subtitle: "å—å±±è€è¡— & ä¸‰æ¯›æ•…å±…",
                    highlight: "è€å›æ´ã€ä¸‹æµ©é‡Œã€å—æ¿±è·¯å¤œæ™¯",
                    events: [
                        { 
                            time: "07:30", 
                            title: "æ±ªå®¶å ¡æ—©å¸‚", 
                            desc: "ğŸ“œ æœ¬åœ°äººçš„èœç±ƒå­ã€‚ğŸ¥¢ æ¨è–¦å˜—è©¦ï¼šã€ç³¯ç±³åœ˜ã€‘(è£¡é¢åŒ…æ²¹æ¢å’Œç³–ç²‰) æˆ–æ˜¯ã€è±Œé›œéºµã€‘(è¦æ±‚ã€Œæé»ƒã€=éºµæ¢ç¡¬ä¸€é»)ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ¥¬", 
                            location: "é‡æ…¶æ±ªå®¶å ¡",
                            opening: "ç´„ 06:00 - 12:00",
                            travelToNext: { dist: "12å…¬é‡Œ", time: "30åˆ†" }
                        },
                        { 
                            time: "11:30", 
                            title: "å‰å¾€å—å±±", 
                            desc: "å—å±±è¢«ç¨±ç‚ºé‡æ…¶çš„ã€Œå¾ŒèŠ±åœ’ã€ï¼Œç©ºæ°£æ¸…æ–°ã€‚", 
                            type: "transport", 
                            emoji: "ğŸš¡", 
                            location: "é‡æ…¶å—å±±",
                            travelToNext: { dist: "2å…¬é‡Œ", time: "8åˆ†" }
                        },
                        { 
                            time: "13:00", 
                            title: "é»ƒæ¡·åŸ¡è€è¡—", 
                            desc: "ğŸ“œ æ›¾æ˜¯èŒ¶é¦¬å¤é“çš„å¿…ç¶“ä¹‹è·¯ã€‚é€™è£¡ä¿å­˜äº†è¨±å¤šå·´æ¸å¤å»ºç¯‰ï¼Œæ²’æœ‰å¸‚å€çš„å–§å›‚ã€‚", 
                            type: "activity", 
                            emoji: "ğŸšï¸", 
                            location: "é‡æ…¶é»ƒæ¡·åŸ¡è€è¡—",
                            opening: "å…¨å¤©é–‹æ”¾",
                            travelToNext: { dist: "0.5å…¬é‡Œ", time: "3åˆ†" }
                        },
                        { 
                            time: "14:00", 
                            title: "ä¸‰æ¯›æ•…å±…", 
                            desc: "ğŸ“œ å°ç£ä½œå®¶ä¸‰æ¯›(é™³å¹³)æŠ—æˆ°æ™‚æœŸæ›¾åœ¨æ­¤å±…ä½ã€‚å¥¹åœ¨ã€Šé¬§å­¸è¨˜ã€‹ä¸­å›æ†¶éé€™è£¡çš„æ™‚å…‰ã€‚å±‹å…§ä¿ç•™äº†å¥¹ç«¥å¹´ç›ªéçš„é¦éŸ†ï¼Œæ˜¯æ–‡é’æœè–åœ°ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ“š", 
                            location: "é‡æ…¶ä¸‰æ¯›æ•…å±…",
                            opening: "09:00 - 17:00 (é€±ä¸€é–‰é¤¨)",
                            travelToNext: { dist: "3å…¬é‡Œ", time: "10åˆ†" }
                        },
                        { 
                            time: "15:00", 
                            title: "è€å›æ´", 
                            desc: "ğŸ“œ åƒå¹´é“è§€ï¼Œæ“šèªªæ±‚è²¡ç‰¹åˆ¥éˆé©—ã€‚é€™è£¡ä¹Ÿæ˜¯ä¿¯ç°é‡æ…¶å…¨æ™¯çš„çµ•ä½³ï¼ˆä¸”å…è²»ï¼‰æ©Ÿä½ã€‚å»ºç¯‰ä¾å±±é‘¿æ´è€Œå»ºï¼Œéå¸¸æœ‰ç‰¹è‰²ã€‚", 
                            type: "activity", 
                            emoji: "ğŸ•", 
                            location: "é‡æ…¶è€å›æ´é“è§€",
                            opening: "08:00 - 17:00",
                            travelToNext: { dist: "2å…¬é‡Œ", time: "8åˆ†" }
                        },
                        { 
                            time: "ä¸‹åˆèŒ¶", 
                            title: "å—å±±Â·çƒ¤èŒ¶", 
                            desc: "ğŸ¥¢ åœ¨ã€Œä¸€æ£µæ¨¹ã€è§€æ™¯å°é™„è¿‘æ‰¾å®¶èŒ¶é¤¨ï¼Œé«”é©—ã€Œåœçˆç…®èŒ¶ã€ã€‚çƒ¤æ©˜å­ã€èŠ±ç”Ÿã€ç´…æ£—ï¼Œé…ä¸Šé‡æ…¶ç‰¹æœ‰çš„æ²±èŒ¶ï¼Œäº«å—æ…¢ç”Ÿæ´»ã€‚", 
                            type: "food", 
                            emoji: "ğŸµ", 
                            location: "é‡æ…¶å—å±±ä¸€æ£µæ¨¹",
                            opening: "10:00 - 22:00",
                            travelToNext: { dist: "6å…¬é‡Œ", time: "15åˆ†" }
                        },
                        { 
                            time: "å‚æ™š", 
                            title: "ä¸‹æµ©é‡Œ & é¾é–€æµ©", 
                            desc: "ğŸ“œ é‡æ…¶é–‹åŸ æ™‚æœŸçš„æ´‹è¡Œèˆ‡ä½¿é¤¨å€ï¼Œä¸­è¥¿åˆç’§å»ºç¯‰ã€‚é€™è£¡è¦‹è­‰äº†é‡æ…¶ä½œç‚ºã€Œæˆ°æ™‚é™ªéƒ½ã€çš„æ­·å²ã€‚æ™šä¸Šé¾é–€æµ©ç‡ˆç«é€šæ˜ï¼Œæ°£æ°›æ¥µä½³ã€‚", 
                            type: "activity", 
                            emoji: "ğŸŒ†", 
                            location: "é‡æ…¶é¾é–€æµ©è€è¡—",
                            opening: "å…¨å¤©é–‹æ”¾",
                            travelToNext: { dist: "2å…¬é‡Œ", time: "6åˆ†" }
                        },
                        { 
                            time: "æ™šé¤", 
                            title: "å—æ¿±è·¯", 
                            desc: "ğŸ¥¢ é€™è£¡è™Ÿç¨±ã€Œé‡æ…¶å¤–ç˜ã€ã€‚æ¨è–¦å“åšã€å—å±±æ³‰æ°´é›ã€‘ï¼Œé€™æ˜¯ä¸€é“ç™¼æºæ–¼å—å±±çš„ç‰¹è‰²èœï¼Œéº»è¾£é®®é¦™ã€‚", 
                            type: "food", 
                            emoji: "ğŸ½ï¸", 
                            location: "é‡æ…¶å—æ¿±è·¯",
                            opening: "è¦–å„é¤å»³è€Œå®š"
                        }
                    ]
                },
                day5: {
                    date: "3/07 (å…­)",
                    title: "å‘Šåˆ¥é‡æ…¶",
                    subtitle: "å…‰ç’°è³¼ç‰© & æœ€å¾Œæ¡è²·",
                    highlight: "æ²å…‰æ£®æ—ã€è€ç«é‹",
                    events: [
                        { 
                            time: "ä¸Šåˆ", 
                            title: "å…‰ç’°è³¼ç‰©å…¬åœ’", 
                            desc: "ğŸ“œ åœ‹å…§é¦–å€‹ã€ŒåŸå¸‚è‡ªç„¶å…±åŒé«”ã€å•†å ´ã€‚å¿…çœ‹é‡é»æ˜¯å®¤å…§æ¤ç‰©åœ’ã€Œæ²å…‰æ£®æ—ã€ï¼Œæœ‰é«˜é”42ç±³çš„å‚ç›´æ™¯è§€èˆ‡ç€‘å¸ƒï¼Œéå¸¸éœ‡æ’¼ã€‚", 
                            type: "activity", 
                            emoji: "ğŸŒ³", 
                            location: "é‡æ…¶å…‰ç’°è³¼ç‰©å…¬åœ’",
                            opening: "10:00 - 22:00",
                            travelToNext: { dist: "0.5å…¬é‡Œ", time: "3åˆ†" }
                        },
                        { 
                            time: "åˆé¤", 
                            title: "å‘¨åª½è€ç«é‹", 
                            desc: "ğŸ¥¢ é›¢é–‹å‰çš„æœ€å¾Œä¸€é “æ­£å®—è€ç«é‹ã€‚å¿…é»èœå–®ï¼šã€é®®æ¯›è‚šã€‘(ä¸ƒä¸Šå…«ä¸‹)ã€ã€ä¹å°ºéµè…¸ã€‘ã€ã€è²¢èœã€‘(è„†çˆ½å£æ„Ÿ)ã€ã€ç´…ç³–ç³ç²‘ã€‘(è§£è¾£ç”œé»)ã€‚", 
                            type: "food", 
                            emoji: "ğŸ²", 
                            location: "é‡æ…¶å‘¨åª½è€ç«é‹",
                            opening: "10:00 - 23:00",
                            travelToNext: { dist: "0.2å…¬é‡Œ", time: "2åˆ†" }
                        },
                        { 
                            time: "ç”œé»", 
                            title: "Crapes Cake", 
                            desc: "ğŸ¥¢ ç¶²ç´…åƒå±¤è›‹ç³•åº—ï¼Œå£å‘³å¤šæ¨£ï¼Œé©åˆè²·ä¸€å¡Šä½œç‚ºé£¯å¾Œç”œé»ï¼Œç•«ä¸‹å®Œç¾å¥é»ã€‚", 
                            type: "food", 
                            emoji: "ğŸ°", 
                            location: "é‡æ…¶Crapes Cake",
                            opening: "11:00 - 21:00",
                            travelToNext: { dist: "18å…¬é‡Œ", time: "25åˆ†" }
                        },
                        { 
                            time: "14:30", 
                            title: "å‰å¾€æ©Ÿå ´", 
                            desc: "å»ºè­° 14:30â€“15:00 å‡ºç™¼ã€‚å‰å¾€æ©Ÿå ´è¾¦ç†ç™»æ©Ÿã€‚å†è¦‹ï¼Œå±±åŸï¼", 
                            type: "transport", 
                            emoji: "ğŸš‡", 
                            location: "é‡æ…¶æ±ŸåŒ—åœ‹éš›æ©Ÿå ´" 
                        },
                        { 
                            time: "17:20", 
                            title: "ç­æ©Ÿèµ·é£›", 
                            desc: "CX929 å‰å¾€é¦™æ¸¯è½‰æ©Ÿã€‚", 
                            type: "transport", 
                            emoji: "ğŸ›«", 
                            location: "é‡æ…¶æ±ŸåŒ—åœ‹éš›æ©Ÿå ´T3" 
                        }
                    ]
                }
            };

            const toggleMap = (index) => {
                setExpandedMapIndex(expandedMapIndex === index ? null : index);
            };

            const openInfoLink = (title) => {
                const query = encodeURIComponent(`é‡æ…¶ ${title} ä»‹ç´¹`);
                window.open(`https://www.google.com/search?q=${query}`, '_blank');
            };

            // ä¿®æ”¹å¾Œçš„ DayButtonï¼šflex-1 è‡ªå‹•å¹³åˆ†å¯¬åº¦
            const DayButton = ({ dayKey, label, date }) => (
                <button
                    onClick={() => { setActiveTab(dayKey); setView('itinerary'); setExpandedMapIndex(null); }}
                    className={`flex-1 py-3 mx-0.5 rounded-lg flex flex-col items-center justify-center transition-all duration-300 min-w-0 border relative overflow-hidden ${
                        activeTab === dayKey && view === 'itinerary'
                            ? 'bg-[#8E0E00] text-[#f9f7f2] border-[#8E0E00] shadow-md transform scale-105 z-10' 
                            : 'bg-white text-stone-500 border-stone-200'
                    }`}
                >
                    {/* å°ç« ç´‹ç†è£é£¾ */}
                    {activeTab === dayKey && view === 'itinerary' && (
                        <div className="absolute inset-0 opacity-10 border-2 border-white m-0.5 rounded-md pointer-events-none"></div>
                    )}
                    <span className="text-[10px] font-medium opacity-80 mb-0.5 font-serif-tc whitespace-nowrap">{date.split(' ')[0]}</span>
                    <span className="text-sm font-bold font-serif-tc whitespace-nowrap">{label}</span>
                </button>
            );

            const WeatherCard = ({ dayData }) => {
                const Icon = dayData.icon;
                return (
                    <div className="mx-5 mb-6 bg-white/60 backdrop-blur-sm rounded-xl p-4 border border-stone-200 flex items-center justify-between shadow-sm relative overflow-hidden group">
                        {/* æ°´å¢¨æšˆæŸ“èƒŒæ™¯ */}
                        <div className="absolute -right-5 -top-5 w-24 h-24 bg-stone-200 rounded-full blur-2xl opacity-40 group-hover:opacity-60 transition-opacity"></div>
                        
                        <div className="flex items-center relative z-10">
                            <div className="bg-white p-2.5 rounded-full shadow-sm mr-3 border border-stone-100 text-stone-600">
                                <Icon size={24} />
                            </div>
                            <div>
                                <div className="text-xs text-stone-500 font-medium font-serif-tc">æ¯æ—¥å¤©å€™</div>
                                <div className="text-sm font-bold text-stone-800 font-serif-tc">{dayData.condition} <span className="text-stone-400">|</span> {dayData.temp}</div>
                            </div>
                        </div>
                        <div className="text-right relative z-10">
                            <div className="flex items-center justify-end text-xs text-[#b45309] font-medium mb-0.5 font-serif-tc">
                                <Shirt size={12} className="mr-1" /> ç©¿æ­å»ºè­°
                            </div>
                            <div className="text-xs text-stone-600 font-serif-tc">{dayData.tip}</div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="bg-rice-paper min-h-screen pb-20 relative animate-fadeIn overflow-hidden">
                    {/* Cover Area (Chinese Style) */}
                    <div className="relative h-72 overflow-hidden bg-clouds shadow-lg border-b-4 border-[#b45309]">
                        {/* Overlay Gradient */}
                        <div className="absolute inset-0 bg-gradient-to-b from-black/30 via-transparent to-black/60"></div>
                        
                        {/* Title Section - Updated to prevent overlap */}
                        <div className="absolute top-6 left-6 z-20 text-[#f9f7f2] w-full pr-16">
                            <div className="flex items-center space-x-2 text-xs font-bold tracking-widest bg-black/30 backdrop-blur-md px-3 py-1 rounded-sm w-fit mb-3 border border-[#f9f7f2]/20 shadow-sm font-serif-tc">
                                <span>ä¼å¤©è‚†å¤œ</span>
                            </div>
                            <h1 className="text-5xl tracking-wide drop-shadow-lg leading-tight font-calligraphy text-[#f9f7f2] mb-1">é‡æ…¶</h1>
                            
                            <div className="flex flex-wrap items-end gap-3 mt-1">
                                <h2 className="text-2xl font-serif-tc font-light tracking-[0.2em] opacity-90 leading-none">é­”å¹»å±±åŸä¹‹æ—…</h2>
                                <div className="flex items-center text-xs opacity-90 drop-shadow-sm font-serif-tc border-l border-white/40 pl-3 pb-0.5">
                                    <CalendarIcon size={12} className="mr-1.5" />
                                    <span className="tracking-wide">2026/03/03 (äºŒ) - 07 (å…­)</span>
                                </div>
                            </div>
                        </div>
                        
                        {/* Info Toggle Button */}
                        <button onClick={() => setView(view === 'info' ? 'itinerary' : 'info')} className="absolute top-6 right-6 z-20 bg-white/10 backdrop-blur-md p-2 rounded-full text-[#f9f7f2] hover:bg-white/20 transition-colors border border-white/20 shadow-sm">
                            <Info size={20} />
                        </button>

                        {/* Bottom Icons Row */}
                        <div className="absolute bottom-8 left-0 right-0 z-50 px-6">
                            <div className="flex justify-between items-center gap-2">
                                {/* Flight KHH */}
                                <button onClick={() => setFlightModalInfo('KHH')} className="flex flex-col items-center group">
                                    <div className="bg-stone-800/80 backdrop-blur-md p-3 rounded-xl border border-[#b45309]/50 shadow-lg group-hover:scale-110 transition-transform">
                                        <CutePlaneIcon size={22} className="text-stone-200" />
                                    </div>
                                    <span className="text-[10px] text-white/80 mt-1 font-serif-tc shadow-black drop-shadow-md">é«˜é›„</span>
                                </button>

                                {/* Exchange Rate */}
                                <button onClick={() => setShowExchangeModal(true)} className="flex flex-col items-center group">
                                    <div className="bg-stone-800/80 backdrop-blur-md p-3 rounded-xl border border-[#b45309]/50 shadow-lg group-hover:scale-110 transition-transform">
                                        <CurrencyIcon size={22} className="text-yellow-500" />
                                    </div>
                                    <span className="text-[10px] text-white/80 mt-1 font-serif-tc shadow-black drop-shadow-md">åŒ¯ç‡</span>
                                </button>

                                {/* Hotel Info */}
                                <button onClick={() => setShowHotelModal(true)} className="flex flex-col items-center group">
                                    <div className="bg-stone-800/80 backdrop-blur-md p-3 rounded-xl border border-[#b45309]/50 shadow-lg group-hover:scale-110 transition-transform">
                                        <HotelBedIcon size={22} className="text-emerald-400" />
                                    </div>
                                    <span className="text-[10px] text-white/80 mt-1 font-serif-tc shadow-black drop-shadow-md">ä½å®¿</span>
                                </button>

                                {/* Flight TPE */}
                                <button onClick={() => setFlightModalInfo('TPE')} className="flex flex-col items-center group">
                                    <div className="bg-stone-800/80 backdrop-blur-md p-3 rounded-xl border border-[#b45309]/50 shadow-lg group-hover:scale-110 transition-transform">
                                        <CutePlaneIcon size={22} className="text-indigo-300" />
                                    </div>
                                    <span className="text-[10px] text-white/80 mt-1 font-serif-tc shadow-black drop-shadow-md">å°åŒ—</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Modals */}
                    {flightModalInfo && <FlightModal onClose={() => setFlightModalInfo(null)} location={flightModalInfo} />}
                    {showExchangeModal && <ExchangeModal onClose={() => setShowExchangeModal(false)} />}
                    {showHotelModal && <HotelModal onClose={() => setShowHotelModal(false)} />}

                    {/* Main Content Area */}
                    <div className="relative -mt-6 bg-rice-paper rounded-t-[2rem] z-30 min-h-[500px] shadow-[0_-8px_20px_-5px_rgba(0,0,0,0.2)]">
                        
                        {view === 'itinerary' ? (
                            <>
                                <div className="sticky top-0 bg-rice-paper/95 backdrop-blur-sm z-40 pt-5 pb-3 px-3 shadow-sm rounded-t-[2rem] border-b border-stone-200/50">
                                    {/* Updated: Flex container for even distribution */}
                                    <div className="flex justify-between items-stretch w-full">
                                        {Object.keys(itineraryData).map((key, index) => (
                                            <DayButton key={key} dayKey={key} label={`Day ${index + 1}`} date={itineraryData[key].date} />
                                        ))}
                                    </div>
                                </div>

                                <div className="px-6 py-5">
                                    <h2 className="text-2xl font-bold text-stone-800 font-serif-tc tracking-wide">{itineraryData[activeTab].title}</h2>
                                    <p className="text-stone-500 text-sm mt-1 font-serif-tc">{itineraryData[activeTab].subtitle}</p>
                                    <div className="mt-3 inline-flex items-center px-3 py-1 bg-red-50 text-red-800 rounded-sm border border-red-100 text-xs font-medium font-serif-tc">
                                        <AlertCircle size={12} className="mr-1.5" />
                                        ç²¾é¸ï¼š{itineraryData[activeTab].highlight}
                                    </div>
                                </div>

                                <WeatherCard dayData={weatherData[activeTab]} />

                                <div className="px-5 pb-8">
                                    {/* Timeline Line */}
                                    <div className="relative border-l-2 border-stone-300 ml-3 space-y-8">
                                        {itineraryData[activeTab].events.map((event, idx) => (
                                            <div key={idx} className="relative pl-8 group">
                                                {/* Timeline Dot */}
                                                <div className="absolute -left-[19px] top-0 w-10 h-10 rounded-full bg-[#f9f7f2] border-4 border-stone-200 shadow-sm flex items-center justify-center text-xl z-10 font-serif-tc">
                                                    {event.emoji}
                                                </div>
                                                
                                                <div className="bg-white rounded-lg p-4 shadow-sm border border-stone-200 hover:shadow-md hover:border-[#b45309]/30 transition-all relative overflow-hidden">
                                                    {/* Card Decor */}
                                                    <div className="absolute top-0 right-0 w-8 h-8 bg-stone-50 rounded-bl-xl z-0"></div>

                                                    <div className="flex justify-between items-start mb-2 relative z-10">
                                                        <span className={`text-xs font-bold px-2 py-0.5 rounded-sm font-serif-tc ${event.time.includes(':') ? 'bg-stone-100 text-stone-600' : 'bg-[#8E0E00] text-white'}`}>{event.time}</span>
                                                        <div className="flex space-x-2">
                                                            <button 
                                                                onClick={(e) => { e.stopPropagation(); openInfoLink(event.title); }} 
                                                                className="p-1.5 rounded-full bg-stone-100 text-stone-500 hover:bg-stone-200 transition-colors"
                                                            >
                                                                <ExternalLink size={14} />
                                                            </button>

                                                            <button onClick={() => toggleMap(idx)} className={`p-1.5 rounded-full transition-colors ${expandedMapIndex === idx ? 'bg-[#b45309] text-white' : 'bg-stone-100 text-stone-400 hover:bg-stone-200'}`}>
                                                                {expandedMapIndex === idx ? <XIcon size={14} /> : <MapIcon size={14} />}
                                                            </button>
                                                        </div>
                                                    </div>
                                                    
                                                    <h3 className="text-lg font-bold text-stone-800 mb-1 font-serif-tc tracking-wide">{event.title}</h3>
                                                    <p className="text-stone-600 text-sm leading-relaxed text-justify">{event.desc}</p>
                                                    
                                                    {event.opening && (
                                                        <div className="mt-2 text-xs text-stone-500 font-medium bg-stone-50 px-2 py-1 rounded-sm w-fit flex items-center font-serif-tc border border-stone-100">
                                                            <ClockIcon size={12} className="mr-1" />
                                                            {event.opening}
                                                        </div>
                                                    )}

                                                    {event.type === 'food' && <div className="mt-3 flex items-center text-xs text-[#b45309] font-medium font-serif-tc"><span className="mr-1 text-base">ğŸ¥¢</span> å°‹å‘³æ¨è–¦</div>}

                                                    {expandedMapIndex === idx && (
                                                        <div className="mt-4 pt-4 border-t border-stone-100 animate-fadeIn">
                                                            <div className="rounded-sm overflow-hidden border border-stone-300 h-48 bg-stone-100 relative shadow-inner">
                                                                <iframe width="100%" height="100%" frameBorder="0" scrolling="no" marginHeight="0" marginWidth="0" src={`https://maps.google.com/maps?q=${encodeURIComponent(event.location)}&t=&z=13&ie=UTF8&iwloc=&output=embed`} title={`Map for ${event.title}`}></iframe>
                                                            </div>
                                                            <div className="mt-3 flex justify-between items-center">
                                                                <div className="flex items-center text-xs text-stone-500 font-serif-tc"><MapPin size={12} className="mr-1" />{event.location}</div>
                                                                <a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(event.location)}`} target="_blank" className="flex items-center text-xs bg-[#b45309] text-white px-3 py-1.5 rounded-sm hover:bg-[#92400e] transition-colors font-serif-tc"><Navigation size={12} className="mr-1" />å°èˆª</a>
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>

                                                {/* Travel Info (Connector to next) */}
                                                {event.travelToNext && (
                                                    <div className="mt-3 mb-6 relative pl-2"> 
                                                        <div className="flex items-center bg-[#f9f7f2] rounded-lg p-2 pr-4 w-fit border border-stone-200 shadow-sm">
                                                            <div className="bg-stone-200 p-1.5 rounded-full mr-2 text-stone-600">
                                                                <CarIcon size={14} />
                                                            </div>
                                                            <div>
                                                                <div className="text-[10px] text-stone-400 flex items-center mb-0.5 font-serif-tc">
                                                                    ä¸‹ä¸€ç«™ <ArrowDown size={10} className="ml-1 animate-bounce-slight" />
                                                                </div>
                                                                <div className="text-xs font-bold text-stone-700 font-serif-tc">
                                                                    {event.travelToNext.time} 
                                                                    <span className="text-stone-400 font-normal ml-1">Â· {event.travelToNext.dist}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </>
                        ) : (
                            <div className="p-6 animate-fadeIn">
                                <h2 className="text-2xl font-bold text-stone-800 mb-6 font-serif-tc border-l-4 border-[#b45309] pl-3">è¡Œç¨‹ç­†è¨˜</h2>
                                <div className="space-y-4">
                                    <div className="bg-white p-5 rounded-xl shadow-sm border border-stone-200 relative overflow-hidden">
                                        <div className="absolute top-0 right-0 w-20 h-20 bg-indigo-50 rounded-bl-[4rem] -mr-8 -mt-8 z-0"></div>
                                        <div className="flex items-center space-x-3 mb-3 relative z-10">
                                            <div className="bg-indigo-100 p-2 rounded-lg text-indigo-700"><MapPin size={20} /></div>
                                            <h3 className="font-bold text-stone-800 font-serif-tc">ä½å®¿å»ºè­°</h3>
                                        </div>
                                        <p className="text-stone-600 text-sm leading-relaxed relative z-10">{tripInfo.location}<br/><span className="text-xs text-stone-400">äº¤é€šæœ€æ–¹ä¾¿ï¼Œç¾é£Ÿèšé›†åœ°ã€‚</span></p>
                                        <div className="mt-3 relative z-10">
                                            <a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent("å¶¼é‡Œæ°‘å®¿(é‡åº†è§‚éŸ³æ¡¥æ­¥è¡Œè¡—åº—)")}`} target="_blank" className="text-xs text-indigo-700 flex items-center font-medium font-serif-tc">æŸ¥çœ‹å€åŸŸåœ°åœ– <ChevronRight size={12} /></a>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-white p-5 rounded-xl shadow-sm border border-stone-200 relative overflow-hidden">
                                        <div className="absolute top-0 right-0 w-20 h-20 bg-amber-50 rounded-bl-[4rem] -mr-8 -mt-8 z-0"></div>
                                        <div className="flex items-center space-x-3 mb-3 relative z-10">
                                            <div className="bg-amber-100 p-2 rounded-lg text-amber-700"><AlertCircle size={20} /></div>
                                            <h3 className="font-bold text-stone-800 font-serif-tc">é‡é»æé†’</h3>
                                        </div>
                                        <ul className="text-stone-600 text-sm space-y-2 list-disc list-inside relative z-10 font-serif-tc">
                                            <li>é‡æ…¶ç‚ºã€Œå±±åŸã€ï¼Œèµ·ä¼å¤§ï¼Œå‹™å¿…ç©¿è‘—<strong>èˆ’é©å¥½èµ°çš„é‹</strong>ã€‚</li>
                                            <li>Day 3 æ­¦éš†è¼ƒé ï¼Œ<strong>åŒ…è»Š</strong>æœ€è¼•é¬†ã€‚</li>
                                            <li>é‡æ…¶å£å‘³åè¾£ï¼Œè…¸èƒƒè—¥å‚™ç”¨ã€‚</li>
                                            <li>å°èˆªåœ¨ç«‹é«”äº¤é€šä¸­æ˜“å¤±éˆï¼Œå•è·¯äººæœ€å¿«ã€‚</li>
                                        </ul>
                                    </div>

                                    <div className="bg-white p-5 rounded-xl shadow-sm border border-stone-200 relative overflow-hidden">
                                        <div className="flex items-center space-x-3 mb-3">
                                            <div className="bg-stone-200 p-2 rounded-lg text-stone-600"><Camera size={20} /></div>
                                            <h3 className="font-bold text-stone-800 font-serif-tc">å¿…æ‹æ‰“å¡é»</h3>
                                        </div>
                                        <div className="flex flex-wrap gap-2">
                                            {['æ´ªå´–æ´å¤œæ™¯', 'é»ƒè‰²æ³•æ‹‰åˆ©', 'æå­å£©ç©¿æ¨“', 'é­æ˜Ÿæ¨“å¤©æ©‹', 'é•·æ±Ÿç´¢é“'].map(tag => (
                                                <span key={tag} className="px-3 py-1 bg-stone-100 text-stone-600 text-xs rounded-full font-serif-tc border border-stone-200">#{tag}</span>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                                <button onClick={() => setView('itinerary')} className="mt-8 w-full py-3 bg-[#2c2c2c] text-[#f9f7f2] rounded-lg font-medium font-serif-tc hover:bg-black transition-colors shadow-lg">è¿”å›è¡Œç¨‹è¡¨</button>
                            </div>
                        )}
                    </div>
                    
                    {/* Floating Map Button */}
                    <div className="fixed bottom-6 right-6 z-40">
                        <button onClick={() => window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent("é‡æ…¶å¸‚")}`, '_blank')} className="bg-[#b45309] text-white p-4 rounded-full shadow-xl shadow-orange-900/30 hover:scale-110 transition-transform flex items-center justify-center border-2 border-[#f9f7f2]">
                            <MapPin size={24} />
                        </button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ChongqingTripApp />);
    </script>
</body>
</html>